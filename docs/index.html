<!DOCTYPE html><html class="default no-js"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@mgdigital/tsinject - v0.2.1</title><meta name="description" content="Documentation for @mgdigital/tsinject - v0.2.1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem(&quot;tsd-theme&quot;) || &quot;os&quot;)</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@mgdigital/tsinject - v0.2.1</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@mgdigital/tsinject - v0.2.1</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#mgdigitaltsinject" id="mgdigitaltsinject" style="color: inherit; text-decoration: none;">
  <h1>@mgdigital/tsinject</h1>
</a>
<p>Lightweight and flexible dependency injection container for TypeScript.</p>
<p><a href="https://badge.fury.io/js/@mgdigital%2Ftsinject"><img src="https://badge.fury.io/js/@mgdigital%2Ftsinject.svg" alt="npm version"></a> <a href="https://codecov.io/gh/mgdigital/tsinject"><img src="https://codecov.io/gh/mgdigital/tsinject/branch/main/graph/badge.svg" alt="codecov"></a></p>

<a href="#documentation" id="documentation" style="color: inherit; text-decoration: none;">
  <h2>Documentation</h2>
</a>
<p>Install with <code>npm add @mgdigital/tsinject</code> or <code>yarn add @mgdigital/tsinject</code>.</p>
<p>See <a href="https://mgdigital.github.io/tsinject/">the documentation</a>.</p>

<a href="#motivation" id="motivation" style="color: inherit; text-decoration: none;">
  <h2>Motivation</h2>
</a>
<p>Several dependency injection solutions exist for TypeScript. Most use either decorators (<a href="https://github.com/inversify/InversifyJS">Inversify</a>; <a href="https://github.com/microsoft/tsyringe">TSyringe</a>) or static class properties (Angular). This has several drawbacks:</p>
<p><span style="color:red">&cross;</span> The types of service that can be defined are restricted to class instances.</p>
<p><span style="color:red">&cross;</span> The code of the class needs modifying to work with the container (e.g. by adding decorators or static properties).</p>
<p><span style="color:red">&cross;</span> It will only work with the <code>experimentalDecorators</code> compiler option enabled.</p>
<p><strong>tsinject</strong> adopts an alternative approach with several objectives:</p>
<p><span style="color:green">&check;</span> Flexibility, composability and reusability of components</p>
<p><span style="color:green">&check;</span> Sharing global resources while avoiding global side effects</p>
<p><span style="color:green">&check;</span> Achieving loose coupling in large applications</p>
<p>tsinject works by defining named factory functions in a container builder, with unique symbols mapping services available in the container to their type. These factory functions can return anything, allowing configuration objects, class instances, functions or any other type of value to be defined as a container service. Any code can be containerized without need for modifications such as annotations or static properties.</p>
<p>Any application that does something useful needs to cause side effects. These might include:</p>
<ul>
<li>Reading or writing some data in a database</li>
<li>Checking the current date and time</li>
<li>Asking the user for input</li>
<li>Logging a message to the console</li>
</ul>
<p>These capabilities are implemented by components of the application, with some components depending on others, and with the implementation or configuration of components often depending on values read from the environment. The quickest way to allow components to communicate with each other is often via globally defined singleton instances. This increases complexity, making code more difficult to debug, test and maintain. Instead, by building components that have their dependencies injected, we can create complex but decoupled applications.</p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2>Usage</h2>
</a>

<a href="#creating-a-container-module-and-defining-services" id="creating-a-container-module-and-defining-services" style="color: inherit; text-decoration: none;">
  <h3>Creating a container module and defining services</h3>
</a>
<p>Take the example of a logging component, that defines services in a container using the following keys (see <a href="https://github.com/mgdigital/tsinject/blob/main/examples/container/loggingModule/keys.ts">./examples/container/loggingModule/keys.ts</a>):</p>
<pre><code class="language-typescript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">loggerConfig</span><span class="hl-1"> = </span><span class="hl-4">Symbol</span><span class="hl-1">(</span><span class="hl-5">&#39;loggerConfig&#39;</span><span class="hl-1">) </span><span class="hl-6">// Provides config values for other logger services</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">logFormatter</span><span class="hl-1"> = </span><span class="hl-4">Symbol</span><span class="hl-1">(</span><span class="hl-5">&#39;logFormatter&#39;</span><span class="hl-1">) </span><span class="hl-6">// Formats log data to a log line string</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">logWriter</span><span class="hl-1"> = </span><span class="hl-4">Symbol</span><span class="hl-1">(</span><span class="hl-5">&#39;logWriter&#39;</span><span class="hl-1">) </span><span class="hl-6">// Writes log lines, e.g. to the console or to a file</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">logger</span><span class="hl-1"> = </span><span class="hl-4">Symbol</span><span class="hl-1">(</span><span class="hl-5">&#39;logger&#39;</span><span class="hl-1">) </span><span class="hl-6">// The logger service that will be used by consumers of this component</span>
</code></pre>
<p>We can make a map of container keys to the type of service they represent (see <a href="https://github.com/mgdigital/tsinject/blob/main/examples/container/loggingModule/services.ts">./examples/container/loggingModule/services.ts</a>):</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> { </span><span class="hl-7">ILogger</span><span class="hl-1">, </span><span class="hl-7">LogFormatter</span><span class="hl-1">, </span><span class="hl-7">LoggerConfig</span><span class="hl-1">, </span><span class="hl-7">LogWriter</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/types&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-7">keys</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./keys&#39;</span><br/><br/><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-4">LoggingServices</span><span class="hl-1"> = {</span><br/><span class="hl-1">  [</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">]: </span><span class="hl-4">LoggerConfig</span><br/><span class="hl-1">  [</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logFormatter</span><span class="hl-1">]: </span><span class="hl-4">LogFormatter</span><br/><span class="hl-1">  [</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logWriter</span><span class="hl-1">]: </span><span class="hl-4">LogWriter</span><br/><span class="hl-1">  [</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logger</span><span class="hl-1">]: </span><span class="hl-4">ILogger</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-7">LoggingServices</span>
</code></pre>
<p>We can then create a <a href="https://mgdigital.github.io/tsinject/modules.html#ContainerModule">ContainerModule</a> by defining a factory function for each service key (see <a href="https://github.com/mgdigital/tsinject/blob/main/examples/container/loggingModule/module.ts">./examples/container/loggingModule/module.ts</a>):</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> { </span><span class="hl-7">ContainerModule</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@mgdigital/tsinject&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> </span><span class="hl-7">LoggingServices</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./services&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-7">processEnvModule</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../processEnvModule&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-7">keys</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./keys&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">consoleLogWriter</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/consoleLogWriter&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">Logger</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/Logger&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">loggerConfigFromEnv</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/config/loggerConfigFromEnv&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">prettyLogFormatter</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/prettyLogFormatter&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">simpleLogFormatter</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;../../logging/simpleLogFormatter&#39;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">loggingModule</span><span class="hl-1">: </span><span class="hl-4">ContainerModule</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-4">processEnvModule</span><span class="hl-1">.</span><span class="hl-4">services</span><span class="hl-1"> &amp;</span><br/><span class="hl-1">  </span><span class="hl-4">LoggingServices</span><br/><span class="hl-1">&gt; = </span><span class="hl-7">builder</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">builder</span><br/><span class="hl-1">  </span><span class="hl-6">// Use another container module that provides services required by this one</span><br/><span class="hl-1">  .</span><span class="hl-8">use</span><span class="hl-1">(</span><span class="hl-7">processEnvModule</span><span class="hl-1">.</span><span class="hl-7">default</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-6">// Define a config object based on environment variables</span><br/><span class="hl-1">  .</span><span class="hl-8">define</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">container</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-8">loggerConfigFromEnv</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">processEnvModule</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">processEnv</span><span class="hl-1">)</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-6">// Provide a different implementation depending on environment variable configuration</span><br/><span class="hl-1">  .</span><span class="hl-8">define</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logFormatter</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">container</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">).</span><span class="hl-7">pretty</span><br/><span class="hl-1">      ? </span><span class="hl-7">prettyLogFormatter</span><br/><span class="hl-1">      : </span><span class="hl-7">simpleLogFormatter</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-8">define</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logWriter</span><span class="hl-1">,</span><br/><span class="hl-1">    () </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">consoleLogWriter</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-8">define</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logger</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">container</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Logger</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logFormatter</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logWriter</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">).</span><span class="hl-7">level</span><br/><span class="hl-1">    )</span><br/><span class="hl-1">  )</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-7">loggingModule</span>
</code></pre>
<p>We can now create a container from this module, get the logger service from the container and log something:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-7">newContainerBuilder</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@mgdigital/tsinject&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-7">loggingModule</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./examples/container/loggingModule&#39;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">container</span><span class="hl-1"> = </span><span class="hl-8">newContainerBuilder</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-8">use</span><span class="hl-1">(</span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">default</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-6">// Decorate the logger config so that output is always pretty</span><br/><span class="hl-1">  .</span><span class="hl-8">decorate</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">f</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">c</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      ...</span><span class="hl-8">f</span><span class="hl-1">(</span><span class="hl-7">c</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-7">pretty:</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-8">createContainer</span><span class="hl-1">()</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">logger</span><span class="hl-1"> = </span><span class="hl-7">container</span><span class="hl-1">.</span><span class="hl-8">get</span><span class="hl-1">(</span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logger</span><span class="hl-1">)</span><br/><br/><span class="hl-7">logger</span><span class="hl-1">.</span><span class="hl-8">info</span><span class="hl-1">(</span><span class="hl-5">&#39;Logging something!&#39;</span><span class="hl-1">)</span>
</code></pre>
<p><strong>Note:</strong> We should only call <a href="https://mgdigital.github.io/tsinject/interfaces/IContainer.html#get">IContainer.get</a> from within a factory function or from the <a href="https://freecontent.manning.com/dependency-injection-in-net-2nd-edition-understanding-the-composition-root/">composition root</a>, avoiding the <a href="https://freecontent.manning.com/the-service-locator-anti-pattern/">service locator anti-pattern</a>.</p>
<p><strong>Note:</strong> When defining a service in the container, if that service key is already defined then the key will <strong>not</strong> be overwritten. This allows modules to be used multiple times without introducing unpredictable behaviour when using decorators. For example of module A and B both depend on module C they can both use module C and then be used together in the same container. If an already defined service needs to be overwritten, this can be done with a decorator.</p>

<a href="#decorators" id="decorators" style="color: inherit; text-decoration: none;">
  <h2>Decorators</h2>
</a>
<p>Decorators allow us to modify an already-defined service. Let&#39;s create a custom logging module that decorates some of the services in the base module defined above:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> { </span><span class="hl-7">ContainerModule</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@mgdigital/tsinject&#39;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-7">loggingModule</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;./examples/container/loggingModule&#39;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">myCustomLoggingModule</span><span class="hl-1">: </span><span class="hl-4">ContainerModule</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-4">loggingModule</span><span class="hl-1">.</span><span class="hl-4">services</span><br/><span class="hl-1">&gt; = </span><span class="hl-7">builder</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">builder</span><br/><span class="hl-1">  .</span><span class="hl-8">use</span><span class="hl-1">(</span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">default</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-6">// Decorate the logger config so that output is always pretty</span><br/><span class="hl-1">  .</span><span class="hl-8">decorate</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">loggerConfig</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">factory</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">container</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      ...</span><span class="hl-8">factory</span><span class="hl-1">(</span><span class="hl-7">container</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-7">pretty:</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-6">// Overwrite the log writer with some other implementation</span><br/><span class="hl-1">  .</span><span class="hl-8">decorate</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">loggingModule</span><span class="hl-1">.</span><span class="hl-7">keys</span><span class="hl-1">.</span><span class="hl-7">logWriter</span><span class="hl-1">,</span><br/><span class="hl-1">    () </span><span class="hl-2">=&gt;</span><span class="hl-1"> () </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">myCustomLogWriter</span><br/><span class="hl-1">  )</span>
</code></pre>
<p>We can also use decorators to achieve features that aren&#39;t explicitly implemented in this library, such as service tagging:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-0">type</span><span class="hl-1"> { </span><span class="hl-7">ContainerModule</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@mgdigital/tsinject&#39;</span><br/><br/><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-4">TaggedServiceType</span><span class="hl-1"> = { </span><span class="hl-7">foo</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1"> }</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">serviceTag</span><span class="hl-1"> = </span><span class="hl-4">Symbol</span><span class="hl-1">(</span><span class="hl-7">serviceTag</span><span class="hl-1">)</span><br/><br/><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-4">ServiceMap</span><span class="hl-1"> = {</span><br/><span class="hl-1">  [</span><span class="hl-7">serviceTag</span><span class="hl-1">]: </span><span class="hl-4">TaggedServiceType</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">myModule</span><span class="hl-1">: </span><span class="hl-4">ContainerModule</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-4">ServiceMap</span><br/><span class="hl-1">&gt; = </span><span class="hl-7">builder</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">builder</span><br/><span class="hl-1">  .</span><span class="hl-8">define</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">serviceTag</span><span class="hl-1">,</span><br/><span class="hl-1">    () </span><span class="hl-2">=&gt;</span><span class="hl-1"> []</span><br/><span class="hl-1">  )</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">myOtherModule</span><span class="hl-1">: </span><span class="hl-4">ContainerModule</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-4">ServiceMap</span><br/><span class="hl-1">&gt; = </span><span class="hl-7">builder</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">builder</span><br/><span class="hl-1">  .</span><span class="hl-8">use</span><span class="hl-1">(</span><span class="hl-7">myModule</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-8">decorate</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">serviceTag</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">// Add a service to the array of already defined services</span><br/><span class="hl-1">    </span><span class="hl-7">factory</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-7">container</span><span class="hl-1"> </span><span class="hl-2">=&gt;</span><span class="hl-1"> [</span><br/><span class="hl-1">      ...</span><span class="hl-8">factory</span><span class="hl-1">(</span><span class="hl-7">container</span><span class="hl-1">),</span><br/><span class="hl-1">      { </span><span class="hl-7">foo:</span><span class="hl-1"> </span><span class="hl-5">&#39;bar&#39;</span><span class="hl-1"> }</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  )</span>
</code></pre>
<p>And that&#39;s it - unlike some other DI containers that claim to be lightweight, tsinject really is tiny and has a simple API, allowing large and complex but loosely coupled applications to be built from small, simple and easily testable components.</p>
<p>See the <a href="https://github.com/mgdigital/tsinject/tree/main/examples">examples</a> folder for a more complete application. It includes a simple tasks service with a REST API that can be started by cloning this repository and running <code>yarn install</code>, <code>yarn build</code> then <code>yarn example:start</code>.</p>
<hr>
<p>Copyright (c) 2021 Mike Gibson, <a href="https://github.com/mgdigital">https://github.com/mgdigital</a></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/ServiceNotFoundError.html" class="tsd-kind-icon">Service<wbr/>Not<wbr/>Found<wbr/>Error</a></li><li class="tsd-kind-class"><a href="classes/TSInjectError.html" class="tsd-kind-icon">TSInject<wbr/>Error</a></li><li class="tsd-kind-interface tsd-has-type-parameter"><a href="interfaces/IContainer.html" class="tsd-kind-icon">IContainer</a></li><li class="tsd-kind-interface tsd-has-type-parameter"><a href="interfaces/IContainerBuilder.html" class="tsd-kind-icon">IContainer<wbr/>Builder</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ContainerKey" class="tsd-kind-icon">Container<wbr/>Key</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#ContainerModule" class="tsd-kind-icon">Container<wbr/>Module</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#Decorator" class="tsd-kind-icon">Decorator</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#Factory" class="tsd-kind-icon">Factory</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#FactoryMap" class="tsd-kind-icon">Factory<wbr/>Map</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#ServiceMap" class="tsd-kind-icon">Service<wbr/>Map</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#ServiceTypeOf" class="tsd-kind-icon">Service<wbr/>Type<wbr/>Of</a></li><li class="tsd-kind-function tsd-has-type-parameter"><a href="modules.html#containerKeys" class="tsd-kind-icon">container<wbr/>Keys</a></li><li class="tsd-kind-function"><a href="modules.html#newContainerBuilder" class="tsd-kind-icon">new<wbr/>Container<wbr/>Builder</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>